{% extends "base.html" %}
{% block body_class %}home-page{% endblock %}
{% block content %}

<!-- Hero Section -->
<section id="home" class="pt-28 pb-20 px-6 bg-gradient-to-r from-pink-100 via-white to-green-100">
  <div class="max-w-7xl mx-auto flex flex-col md:flex-row items-center">
    <div class="md:w-1/2 mb-10 md:mb-0">
      <h2 class="text-4xl md:text-5xl font-bold mb-6 leading-tight">
        Temukan Skincare Lokal Terbaik Sesuai Jenis Kulitmu!
      </h2>
      <p class="text-lg text-gray-600 mb-8">
        Rekomendasi produk skincare lokal yang disesuaikan dengan kebutuhan kulit dan preferensi Anda.
      </p>
      <div class="flex space-x-4">
        <a href="{{ url_for('page_rekomendasi') }}" 
           class="bg-pink-500 hover:bg-pink-600 text-white px-8 py-3 rounded-full font-medium transition">
          Mulai Sekarang
        </a>
        <button class="border border-pink-400 text-pink-600 px-8 py-3 rounded-full font-medium hover:bg-pink-50 transition cursor-default">
          Isi Profil Kulit
        </button>
      </div>
    </div>
    <div class="md:w-1/2 flex justify-center">
      <img src="{{ url_for('static', filename='images/ilustrasi-skincare.png') }}" 
          alt="Ilustrasi skincare" 
          class="hero-img rounded-xl shadow-lg object-contain mx-auto 
                  max-w-[150px] md:max-w-[250px] lg:max-w-[320px] h-auto">
    </div>
  </div>
</section>

<!-- Brand Lokal Rekomendasi -->
<section class="py-12 bg-gray-50 overflow-hidden">
  <div class="container mx-auto px-6">
    <h2 class="text-3xl font-bold text-center mb-10 text-slate-800">Brand Lokal Rekomendasi</h2>

    <div class="brand-slider">
      <div class="brand-track">
        <img src="{{ url_for('static', filename='images/Brand-Wardah.png') }}" alt="Wardah">
        <img src="{{ url_for('static', filename='images/Brand-Emina.png') }}" alt="Emina">
        <img src="{{ url_for('static', filename='images/Brand-Avoskin.png') }}" alt="Avoskin">
        <img src="{{ url_for('static', filename='images/Brand-Npure.png') }}" alt="NPURE">
        <img src="{{ url_for('static', filename='images/Brand-Azarine.png') }}" alt="Azarine">
        <img src="{{ url_for('static', filename='images/Brand-Elsheskin.png') }}" alt="Elsheskin">
        <img src="{{ url_for('static', filename='images/Brand-ERHA.png') }}" alt="ERHA">

        <img src="{{ url_for('static', filename='images/Brand-Wardah.png') }}" alt="Wardah">
        <img src="{{ url_for('static', filename='images/Brand-Emina.png') }}" alt="Emina">
        <img src="{{ url_for('static', filename='images/Brand-Avoskin.png') }}" alt="Avoskin">
        <img src="{{ url_for('static', filename='images/Brand-Npure.png') }}" alt="NPURE">
        <img src="{{ url_for('static', filename='images/Brand-Azarine.png') }}" alt="Azarine">
        <img src="{{ url_for('static', filename='images/Brand-Elsheskin.png') }}" alt="Elsheskin">
        <img src="{{ url_for('static', filename='images/Brand-ERHA.png') }}" alt="ERHA">
      </div>
    </div>
  </div>
</section>

<!-- Produk Preview + Filter -->
<section id="products" class="py-16 px-6 bg-white">
  <div class="max-w-7xl mx-auto">
    <h2 class="text-3xl font-bold text-center mb-8">Produk Skincare Lokal</h2>

    <div class="grid grid-cols-1 md:grid-cols-4 gap-8">
      <!-- Sidebar Filter -->
      <aside class="md:col-span-1 bg-gray-50 p-6 rounded-lg shadow">
        <h3 class="text-xl font-semibold mb-4">Filter Produk</h3>
        
        <!-- Search -->
        <div class="mb-6">
          <label class="block text-sm font-medium text-gray-700 mb-1">Cari Produk</label>
          <input type="text" id="searchText" name="search" placeholder="Nama produk..."
            value="{{ request.args.get('search', '') }}"
            class="w-full px-3 py-2 border rounded-lg focus:ring-2 focus:ring-pink-400">
        </div>

        <!-- Brand -->
        <div class="mb-6">
          <h4 class="font-semibold mb-2">Brand</h4>
          <div class="flex flex-col space-y-2 text-sm">
            <label><input type="checkbox" name="brand" value="Wardah" class="filter-brand mr-2"> Wardah</label>
            <label><input type="checkbox" name="brand" value="Emina" class="filter-brand mr-2"> Emina</label>
            <label><input type="checkbox" name="brand" value="Avoskin" class="filter-brand mr-2"> Avoskin</label>
            <label><input type="checkbox" name="brand" value="NPURE" class="filter-brand mr-2"> NPURE</label>
            <label><input type="checkbox" name="brand" value="Azarine" class="filter-brand mr-2"> Azarine</label>
            <label><input type="checkbox" name="brand" value="Elsheskin" class="filter-brand mr-2"> Elsheskin</label>
            <label><input type="checkbox" name="brand" value="ERHA" class="filter-brand mr-2"> ERHA</label>
          </div>
        </div>

        <!-- Kategori -->
        <div class="mb-6">
          <h4 class="font-semibold mb-2">Kategori</h4>
          <div class="flex flex-col space-y-2 text-sm">
            <label><input type="checkbox" name="category" value="facialwash" class="filter-category mr-2"> Facial Wash</label>
            <label><input type="checkbox" name="category" value="toner" class="filter-category mr-2"> Toner</label>
            <label><input type="checkbox" name="category" value="serum" class="filter-category mr-2"> Serum</label>
            <label><input type="checkbox" name="category" value="moisturizer" class="filter-category mr-2"> Moisturizer</label>
            <label><input type="checkbox" name="category" value="sunscreen" class="filter-category mr-2"> Sunscreen</label>
          </div>
        </div>

        <!-- Kriteria Khusus -->
        <div class="mb-6">
          <h4 class="font-semibold mb-2">Kriteria Khusus</h4>
          <div class="flex flex-col space-y-2 text-sm">
            <label><input type="checkbox" id="filterAlcoholFree" class="mr-2"> ðŸš« Alcohol-Free</label>
            <label><input type="checkbox" id="filterFragranceFree" class="mr-2"> ðŸŒ¸ Fragrance-Free</label>
            <label><input type="checkbox" id="filterNonComedogenic" class="mr-2"> âœ… Non-Comedogenic</label>
          </div>
        </div>

        <button id="btnFilter" 
          class="w-full bg-pink-500 text-white px-4 py-2 rounded-lg hover:bg-pink-600 transition">
          Terapkan Filter
        </button>
      </aside>

    <!-- Produk Grid -->
    <div class="md:col-span-3">
      <div id="produkGridHome" class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-6">
        {% for item in items[:6] %}  
        <div class="produk-card bg-white p-4 rounded-lg shadow hover:shadow-lg transition"
             data-nama="{{ item.nama|lower }}"
             data-brand="{{ item.brand|lower }}"
             data-kategori="{{ item.kategori|lower }}"
             data-alcohol_free="{{ 'yes' if item.alcohol_free else 'no' }}"
             data-fragrance_free="{{ 'yes' if item.fragrance_free else 'no' }}"
             data-non_comedogenic="{{ 'yes' if item.non_comedogenic else 'no' }}">

          <center>
            <img src="{{ item.image_url }}"
                 alt="{{ item.nama }}"
                 class="w-full h-48 object-cover rounded-lg mb-3">
          </center>
          
          <h3 class="font-bold text-lg">{{ item.nama }}</h3>
          <p class="text-sm text-gray-600">
            {{ item.brand }} | 
            {{ item.kategori.replace('facialwash','Facial Wash')
                            .replace('moisturizer','Moisturizer')
                            .replace('serum','Serum')
                            .replace('toner','Toner')
                            .replace('sunscreen','Sunscreen') }}
          </p>
          <p class="text-sm text-gray-500 mt-2">{{ item.kandungan }}</p>

          <!-- Klaim Produk -->
          <div class="mt-2 flex flex-wrap gap-2 text-sm">
            {% if item.alcohol_free %}
              <span class="px-2 py-1 bg-blue-100 text-blue-600 rounded-full">ðŸš« Alcohol-Free</span>
            {% endif %}
            {% if item.fragrance_free %}
              <span class="px-2 py-1 bg-pink-100 text-pink-600 rounded-full">ðŸŒ¸ Fragrance-Free</span>
            {% endif %}
            {% if item.non_comedogenic %}
              <span class="px-2 py-1 bg-green-100 text-green-600 rounded-full">âœ… Non-Comedogenic</span>
            {% endif %}
          </div>

          <button 
            class="btn-manfaat mt-3 w-full text-xs bg-pink-100 text-pink-600 py-2 rounded-lg hover:bg-pink-200 transition"
            data-manfaat="{{ item.manfaat }}">
            Lihat Deskripsi
          </button>
    </div>
    {% endfor %} </div>

      <div id="manfaatModal" class="fixed inset-0 z-50 hidden">
        <div class="absolute inset-0 bg-black bg-opacity-50"></div>
        <div class="relative bg-white max-w-md mx-auto mt-40 p-6 rounded-xl shadow-lg">
          <h3 class="text-lg font-bold mb-3">Deskripsi Produk</h3>
          <p id="manfaatContent" class="text-sm text-gray-700 leading-relaxed"></p>
          <button id="closeManfaat" class="mt-4 w-full bg-pink-500 text-white py-2 rounded-lg">
            Tutup
          </button>
        </div>
      </div>

      <div class="mt-8 flex justify-center">
        <a href="{{ url_for('page_produk', page=1) }}" 
           class="bg-pink-500 hover:bg-pink-600 text-white px-6 py-2 rounded-full font-medium transition">
          Lihat Semua Produk
        </a>
      </div>
    </div>
  </div>
</section>

<!-- Chatbot Preview -->
<section class="py-16 px-6 bg-gradient-to-r from-green-50 to-pink-50">
  <div class="max-w-4xl mx-auto bg-white rounded-xl shadow-md overflow-hidden p-8 text-center">
    <h2 class="text-3xl font-bold mb-6">Chatbot 24/7</h2>
    <p class="text-gray-600 mb-6">Tanyakan masalah kulitmu dan dapatkan jawaban instan kapan saja.</p>
    <a href="{{ url_for('page_chatbot') }}" 
       class="bg-pink-500 hover:bg-pink-600 text-white px-8 py-3 rounded-full font-medium text-lg transition">
      Coba Chatbot
    </a>
  </div>
</section>

<!-- Tentang Section -->
<section id="about" class="py-16 px-6 bg-white">
  <div class="max-w-7xl mx-auto flex flex-col md:flex-row items-center">
    <div class="md:w-1/2 mb-10 md:mb-0 md:pr-10">
      <h2 class="text-3xl font-bold mb-6">Tentang Skinalyze</h2>
      <p class="text-gray-600 mb-4">
        Skinalyze adalah platform rekomendasi produk skincare lokal Indonesia yang dikembangkan untuk membantu Anda menemukan produk terbaik sesuai dengan jenis dan kebutuhan kulit Anda.
      </p>
      <p class="text-gray-600 mb-6">
        Data produk kami diseleksi dari berbagai sumber terpercaya termasuk Sociolla, dengan fokus pada brand lokal berkualitas seperti Wardah, Emina, Avoskin, dan lainnya.
      </p>
    </div>
    <div class="md:w-1/2 flex justify-center">
      <img src="{{ url_for('static', filename='images/ilustrasi-skincare.png') }}" 
          alt="Ilustrasi skincare" 
          class="hero-img rounded-xl shadow-lg object-contain mx-auto 
                  max-w-[150px] md:max-w-[250px] lg:max-w-[320px] h-auto">
    </div>
  </div>
</section>

<script>
document.getElementById("btnFilter").addEventListener("click", function() {
    let url = "/produk?";
    let search = document.getElementById("searchText").value;
    if (search) url += "search=" + encodeURIComponent(search) + "&";

    document.querySelectorAll(".filter-brand:checked").forEach(cb => {
        url += "brand=" + encodeURIComponent(cb.value) + "&";
    });

    document.querySelectorAll(".filter-category:checked").forEach(cb => {
        url += "kategori=" + encodeURIComponent(cb.value) + "&";
    });

    if (document.getElementById("filterAlcoholFree").checked) url += "alcohol_free=true&";
    if (document.getElementById("filterFragranceFree").checked) url += "fragrance_free=true&";
    if (document.getElementById("filterNonComedogenic").checked) url += "non_comedogenic=true&";

    window.location.href = url;
});
</script>

<script>
  const params = new URLSearchParams(window.location.search);

  document.querySelectorAll("input[name='brand']").forEach(cb => {
    if (params.getAll("brand").map(b => b.toUpperCase()).includes(cb.value.toUpperCase())) {
      cb.checked = true;
    }
  });

  document.querySelectorAll("input[name='category']").forEach(cb => {
    // Sesuaikan pengecekan dengan 'category'
    if (params.getAll("category").map(c => c.toLowerCase()).includes(cb.value.toLowerCase())) {
      cb.checked = true;
    }
  });

  if (params.get("alcohol_free") === "true") document.getElementById("filterAlcoholFree").checked = true;
  if (params.get("fragrance_free") === "true") document.getElementById("filterFragranceFree").checked = true;
  if (params.get("non_comedogenic") === "true") document.getElementById("filterNonComedogenic").checked = true;

  document.getElementById("searchText").value = params.get("search") || "";
</script>

<script>
document.querySelectorAll(".btn-manfaat").forEach(btn => {
  btn.addEventListener("click", function () {
    document.getElementById("manfaatContent").innerText = this.dataset.manfaat;
    document.getElementById("manfaatModal").classList.remove("hidden");
  });
});

document.getElementById("closeManfaat").addEventListener("click", () => {
  document.getElementById("manfaatModal").classList.add("hidden");
});
</script>

{% endblock %}





